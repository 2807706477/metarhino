import{v as R,b as z,g as A,_ as D}from"./index.55d7b75d.js";/* empty css               */import{d as H,r as d,j as K,b as E,o as G,aK as V,F as _,aH as x,aT as r,aU as t,H as g,G as Q,aX as m,aI as k,u as C,aW as v,aP as W,bx as X,bK as J,bL as O,bh as Y,bM as Z,aR as ee,bd as ae,bm as oe,b6 as te,bN as re}from"./arco.c01548ff.js";import{j as se,e as le}from"./vue.c31cb100.js";import"./chart.a60a60a0.js";const ne=["src"],ie={key:0,class:"overlay"},ce=H({__name:"index",setup(ue){const{t:$}=R.exports.useI18n(),l=se("login-config",{rememberMe:!0,username:"gofly",password:"gofly123"}),h=d(),e=K({username:l.value.username,password:l.value.password,captcha:"",codeid:"",expired:!1}),c=d(),I=a=>{c.value&&clearTimeout(c.value);const o=a-Date.now();if(o<=0){e.expired=!0;return}c.value=setTimeout(()=>{e.expired=!0},o)};E(()=>{c.value&&clearTimeout(c.value)});const b=d(),w=d(!1),p=async()=>{const a=await A({type:"image"}),{id:o,show:u,img:i,expireTime:s}=a;e.codeid=o,w.value=u,b.value=i,e.expired=!1,I(s)},M=z(),y=le(),f=d(!1),T=async()=>{try{if(await h.value?.validate())return;f.value=!0,await M.login({username:e.username,password:e.password,captcha:e.captcha,codeid:e.codeid});const{redirect:u,...i}=y.currentRoute.value.query;var a=u;a=="notFound"&&(a="home"),y.replace({name:a||"home",query:{...i}});const{rememberMe:s}=l.value;l.value.username=s?e.username:"",l.value.password=s?e.password:"",W.success({content:$("login.form.login.success"),id:"errmsg"})}catch{p(),e.captcha=""}finally{f.value=!1}};return G(()=>{p()}),(a,o)=>{const u=V("icon-user"),i=X,s=J,B=V("icon-lock"),N=O,S=Y,q=Z,U=ee,j=ae,F=oe,L=te,P=re;return _(),x(P,{ref_key:"formRef",ref:h,model:e,"label-col-style":{display:"none"},"wrapper-col-style":{flex:1},size:"large",onSubmit:T},{default:r(()=>[t(s,{field:"username","hide-label":"",rules:[{required:!0,message:a.$t("login.form.userName.errMsg")}],"validate-trigger":["change","blur"]},{default:r(()=>[t(i,{modelValue:e.username,"onUpdate:modelValue":o[0]||(o[0]=n=>e.username=n),placeholder:a.$t("login.form.userName.placeholder"),"allow-clear":""},{prefix:r(()=>[t(u)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),t(s,{field:"password","hide-label":"",rules:[{required:!0,message:a.$t("login.form.password.errMsg")}],"validate-trigger":["change","blur"]},{default:r(()=>[t(N,{modelValue:e.password,"onUpdate:modelValue":o[1]||(o[1]=n=>e.password=n),placeholder:a.$t("login.form.password.placeholder"),"allow-clear":""},{prefix:r(()=>[t(B)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),w.value?(_(),x(s,{key:0,field:"captcha","hide-label":"",rules:[{required:!0,message:a.$t("login.form.verification.errMsg")}]},{default:r(()=>[t(i,{modelValue:e.captcha,"onUpdate:modelValue":o[2]||(o[2]=n=>e.captcha=n),placeholder:a.$t("login.form.verification.placeholder"),"max-length":4,"allow-clear":"",style:{flex:"1 1"},"hide-button":""},null,8,["modelValue","placeholder"]),g("div",{class:"captcha-container",onClick:p},[t(S,{content:a.$t("login.form.clickverification")},{default:r(()=>[g("img",{src:b.value,alt:"\u9A8C\u8BC1\u7801",class:"captcha"},null,8,ne)]),_:1},8,["content"]),e.expired?(_(),Q("div",ie,[g("p",null,m(a.$t("login.form.verification.expired")),1)])):k("",!0)])]),_:1},8,["rules"])):k("",!0),t(s,{style:{"margin-top":"-5px","margin-bottom":"15px"}},{default:r(()=>[t(j,{justify:"space-between",align:"center",class:"w-full"},{default:r(()=>[t(q,{modelValue:C(l).rememberMe,"onUpdate:modelValue":o[3]||(o[3]=n=>C(l).rememberMe=n)},{default:r(()=>[v(m(a.$t("login.form.rememberPassword")),1)]),_:1},8,["modelValue"]),t(U,null,{default:r(()=>[v(m(a.$t("login.form.forgetPassword")),1)]),_:1})]),_:1})]),_:1}),t(s,null,{default:r(()=>[t(L,{direction:"vertical",fill:"",class:"w-full"},{default:r(()=>[t(F,{class:"btn",type:"primary",loading:f.value,"html-type":"submit",size:"large",long:""},{default:r(()=>[v(m(a.$t("login.form.login")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["model"])}}});const ge=D(ce,[["__scopeId","data-v-0281b724"]]);export{ge as default};
