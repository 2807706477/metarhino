import{v as E,b as L,a as S,g as k,_ as q}from"./index.fe83b6cf.js";/* empty css               */import{d as A,r as n,j as N,w as T,o as z,b6 as M,bN as j,F as K,aH as R,aT as t,aP as w,aK as U,aU as l,aW as C,aX as I,bx as H,bK as P,bm as Q}from"./arco.31164f47.js";import{e as W}from"./vue.85c125e1.js";import{E as X}from"./regexp.c0bbd358.js";import"./chart.0656511d.js";const G=A({__name:"index",setup(J){const{t:r}=E.exports.useI18n(),m=n(),a=N({email:"",captcha:""}),B=L(),_=W(),d=n(!1),V=async()=>{try{if(await m.value?.validate())return;d.value=!0,await B.login({email:a.email,captcha:a.captcha});const{redirect:f,...u}=_.currentRoute.value.query;var e=f;e=="notFound"&&(e="home"),_.replace({name:e||"home",query:{...u}}),w.success({content:r("login.form.login.success"),id:"errmsg"})}catch{a.captcha=""}finally{d.value=!1}},h=n(),i=n(60),s=n("\u83B7\u53D6\u9A8C\u8BC1\u7801"),p=n(!1),{currentLocale:x}=S();T(x,(e,o)=>{s.value=r("login.form.getcode")}),z(()=>{s.value=r("login.form.getcode")});const y=()=>{window.clearInterval(h.value),i.value=60,s.value=r("login.form.getcode"),p.value=!1},c=n(!1),$=async()=>{if(!(c.value||await m.value?.validateField("email")))try{c.value=!0,s.value=r("login.form.sendding"),await k({type:"email",email:a.email}),c.value=!1,p.value=!0,s.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${i.value-=1}s)`,w.success({content:"\u90AE\u4EF6\u53D1\u9001\u6210\u529F",id:"email"}),h.value=window.setInterval(()=>{i.value-=1,s.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${i.value}s)`,i.value<=0&&y()},1e3)}catch{y()}finally{c.value=!1}};return(e,o)=>{const f=U("icon-email"),u=H,v=P,b=Q,F=M,D=j;return K(),R(D,{class:"email-form",ref_key:"formRef",ref:m,model:a,"label-col-style":{display:"none"},"wrapper-col-style":{flex:1},size:"large",onSubmit:V},{default:t(()=>[l(v,{field:"email","hide-label":"",rules:[{required:!0,message:e.$t("login.form.email.rules")},{match:X,message:e.$t("login.form.email.format")}]},{default:t(()=>[l(u,{modelValue:a.email,"onUpdate:modelValue":o[0]||(o[0]=g=>a.email=g),placeholder:e.$t("login.form.getpemail.placeholder"),"allow-clear":""},{prefix:t(()=>[l(f)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),l(v,{field:"captcha","hide-label":"",rules:[{required:!0,message:e.$t("login.form.verification.errMsg")}]},{default:t(()=>[l(u,{modelValue:a.captcha,"onUpdate:modelValue":o[1]||(o[1]=g=>a.captcha=g),placeholder:e.$t("login.form.verification.placeholder"),"max-length":6,"allow-clear":"",style:{flex:"1 1"}},null,8,["modelValue","placeholder"]),l(b,{class:"captcha-btn",loading:c.value,disabled:p.value,size:"large",onClick:$},{default:t(()=>[C(I(s.value),1)]),_:1},8,["loading","disabled"])]),_:1},8,["rules"]),l(v,null,{default:t(()=>[l(F,{direction:"vertical",fill:"",class:"w-full"},{default:t(()=>[l(b,{disabled:a.captcha.length!=6,class:"btn",type:"primary",loading:d.value,"html-type":"submit",size:"large",long:""},{default:t(()=>[C(I(e.$t("login.form.login")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model"])}}});const oe=q(G,[["__scopeId","data-v-4e5f1503"]]);export{oe as default};
