import{g as y,_ as U}from"./index.55d7b75d.js";/* empty css               */import{d as q,r as t,c as P,F as p,aH as f,aT as r,aU as s,aI as B,aW as M,aX as N,G as T,aY as z,aP as b,bx as L,bK as O,bm as R,bL as G,bN as H,aO as K}from"./arco.c01548ff.js";import{s as W}from"./index.b4448482.js";import{P as X,E as Y}from"./regexp.c0bbd358.js";import"./chart.a60a60a0.js";import"./vue.c31cb100.js";const j=q({__name:"VerifyModel",setup(x,{expose:E}){const i=t(!1),v=t(),o=t(),h=P(()=>`\u4FEE\u6539${o.value==="mobile"?"\u624B\u673A\u53F7":o.value==="email"?"\u90AE\u7BB1":"\u5BC6\u7801"}`),e=t({type:"",mobile:"",email:"",captcha:"",oldpassword:"",newpassword:"",repassword:""}),V=t(),n=t(60),m=t("\u83B7\u53D6\u9A8C\u8BC1\u7801"),w=t(!1),C=()=>{window.clearInterval(V.value),n.value=60,m.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",w.value=!1},D=()=>{v.value?.resetFields(),C()},c=t(!1),A=async()=>{if(await v.value?.validateField(o.value==="mobile"?"mobile":"email"))return!1;try{c.value=!0,m.value="\u53D1\u9001\u4E2D...",o.value==="phone"?await y({type:"mobile",mobile:e.value.mobile}):o.value==="email"&&await y({type:"email",email:e.value.email}),c.value=!1,w.value=!0,m.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${n.value-=1}s)`,b.success("\u53D1\u9001\u6210\u529F"),V.value=window.setInterval(()=>{n.value-=1,m.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${n.value}s)`,n.value<=0&&C()},1e3)}catch{C()}finally{c.value=!1}},k=async()=>{if(await v.value?.validate())return!1;try{if(i.value=!0,o.value==="password"){if(e.value.newpassword!==e.value.repassword)return b.error("\u4E24\u6B21\u65B0\u5BC6\u7801\u4E0D\u4E00\u81F4"),i.value=!1,!1;if(e.value.newpassword===e.value.oldpassword)return b.error("\u65B0\u5BC6\u7801\u4E0E\u65E7\u5BC6\u7801\u4E0D\u80FD\u76F8\u540C"),i.value=!1,!1}return await W(e.value),i.value=!1,b.success("\u4FEE\u6539\u6210\u529F"),!0}catch{return i.value=!1,!1}},F=t(!1);return E({open:l=>{o.value=l,e.value.type=l,F.value=!0}}),(l,a)=>{const g=L,d=O,$=R,_=G,I=H,S=K;return p(),f(S,{visible:F.value,"onUpdate:visible":a[6]||(a[6]=u=>F.value=u),title:h.value,"ok-loading":i.value,onBeforeOk:k,onClose:D},{default:r(()=>[s(I,{model:e.value,ref_key:"formRef",ref:v,"auto-label-width":"",size:"large"},{default:r(()=>[o.value=="mobile"?(p(),f(d,{key:0,field:"mobile",label:l.$t("userSetting.label.mobile"),rules:[{required:!0,message:l.$t("userSetting.placeholder.Please")+l.$t("userSetting.label.mobile")},{match:X,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7"}]},{default:r(()=>[s(g,{modelValue:e.value.mobile,"onUpdate:modelValue":a[0]||(a[0]=u=>e.value.mobile=u),placeholder:l.$t("userSetting.placeholder.Fill")+l.$t("userSetting.label.mobile"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):B("",!0),o.value=="email"?(p(),f(d,{key:1,field:"email",label:l.$t("userSetting.label.email"),rules:[{required:!0,message:l.$t("userSetting.placeholder.Please")+l.$t("userSetting.label.email")},{match:Y,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u90AE\u7BB1"}]},{default:r(()=>[s(g,{modelValue:e.value.email,"onUpdate:modelValue":a[1]||(a[1]=u=>e.value.email=u),placeholder:l.$t("userSetting.placeholder.Fill")+l.$t("userSetting.label.email"),"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["label","rules"])):B("",!0),o.value=="mobile"||o.value=="email"?(p(),f(d,{key:2,field:"captcha",label:"\u9A8C\u8BC1\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]},{default:r(()=>[s(g,{modelValue:e.value.captcha,"onUpdate:modelValue":a[2]||(a[2]=u=>e.value.captcha=u),placeholder:"\u8F93\u5165\u9A8C\u8BC1\u7801","max-length":6,"allow-clear":"",style:{flex:"1 1"}},null,8,["modelValue"]),s($,{class:"captcha-btn",loading:c.value,disabled:w.value,size:"large",onClick:A},{default:r(()=>[M(N(m.value),1)]),_:1},8,["loading","disabled"])]),_:1})):B("",!0),s(d,{field:"oldpassword",label:"\u5F53\u524D\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801"}]},{default:r(()=>[s(_,{modelValue:e.value.oldpassword,"onUpdate:modelValue":a[3]||(a[3]=u=>e.value.oldpassword=u),placeholder:"\u8F93\u5165\u5F53\u524D\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),o.value=="password"?(p(),T(z,{key:3},[s(d,{field:"newpassword",label:"\u65B0\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801"}]},{default:r(()=>[s(_,{modelValue:e.value.newpassword,"onUpdate:modelValue":a[4]||(a[4]=u=>e.value.newpassword=u),placeholder:"\u8F93\u5165\u65B0\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),s(d,{field:"repassword",label:"\u786E\u8BA4\u65B0\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u786E\u8BA4\u65B0\u5BC6\u7801"}]},{default:r(()=>[s(_,{modelValue:e.value.repassword,"onUpdate:modelValue":a[5]||(a[5]=u=>e.value.repassword=u),placeholder:"\u8F93\u5165\u786E\u8BA4\u65B0\u5BC6\u7801"},null,8,["modelValue"])]),_:1})],64)):B("",!0)]),_:1},8,["model"])]),_:1},8,["visible","title","ok-loading"])}}});const se=U(j,[["__scopeId","data-v-08c2cbda"]]);export{se as default};
