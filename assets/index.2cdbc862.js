import{v as $,b as E,a as A,g as L,_ as S}from"./index.ec13b3f4.js";/* empty css               */import{d as k,r as u,j as q,w as N,o as P,F as T,aH as z,aT as n,aU as o,aW as y,aX as C,aP as w,bx as M,bK as j,bm as R,b6 as U,bN as H}from"./arco.31164f47.js";import{e as K}from"./vue.85c125e1.js";import{P as Q}from"./regexp.c0bbd358.js";import"./chart.0656511d.js";const W=k({__name:"index",setup(X){const{t:s}=$.exports.useI18n(),m=u(),a=q({mobile:"",captcha:""}),B=E(),g=K(),p=u(!1),F=async()=>{try{if(await m.value?.validate())return;p.value=!0,await B.login({mobile:a.mobile,captcha:a.captcha});const{redirect:d,...i}=g.currentRoute.value.query;var e=d;e=="notFound"&&(e="home"),g.replace({name:e||"home",query:{...i}}),w.success({content:s("login.form.login.success"),id:"errmsg"})}catch{a.captcha=""}finally{p.value=!1}},h=u(),r=u(60),t=u("\u83B7\u53D6\u9A8C\u8BC1\u7801"),f=u(!1),{currentLocale:I}=A();N(I,(e,l)=>{t.value=s("login.form.getcode")}),P(()=>{t.value=s("login.form.getcode")});const _=()=>{window.clearInterval(h.value),r.value=60,t.value=s("login.form.getcode"),f.value=!1},c=u(!1),V=async()=>{if(!(c.value||await m.value?.validateField("mobile")))try{c.value=!0,t.value=s("login.form.sendding"),await L({type:"mobile",mobile:a.mobile}),c.value=!1,f.value=!0,t.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${r.value-=1}s)`,w.success("\u4EC5\u63D0\u4F9B\u6548\u679C\u6F14\u793A\uFF0C\u5B9E\u9645\u4F7F\u7528\u8BF7\u67E5\u770B\u4EE3\u7801\u53D6\u6D88\u76F8\u5173\u6CE8\u91CA"),h.value=window.setInterval(()=>{r.value-=1,t.value=`\u83B7\u53D6\u9A8C\u8BC1\u7801(${r.value}s)`,r.value<=0&&_()},1e3)}catch{_()}finally{c.value=!1}};return(e,l)=>{const d=M,i=j,b=R,x=U,D=H;return T(),z(D,{ref_key:"formRef",ref:m,model:a,"label-col-style":{display:"none"},"wrapper-col-style":{flex:1},size:"large",onSubmit:F},{default:n(()=>[o(i,{field:"mobile","hide-label":"",rules:[{required:!0,message:e.$t("login.form.phone.placeholder")},{match:Q,message:e.$t("login.form.phone.format")}]},{default:n(()=>[o(d,{modelValue:a.mobile,"onUpdate:modelValue":l[0]||(l[0]=v=>a.mobile=v),placeholder:e.$t("login.form.phone.placeholder"),"max-length":11,"allow-clear":""},null,8,["modelValue","placeholder"])]),_:1},8,["rules"]),o(i,{field:"captcha","hide-label":"",rules:[{required:!0,message:e.$t("login.form.verification.errMsg")}]},{default:n(()=>[o(d,{modelValue:a.captcha,"onUpdate:modelValue":l[1]||(l[1]=v=>a.captcha=v),placeholder:e.$t("login.form.verification.placeholder"),"max-length":4,"allow-clear":"",style:{flex:"1 1"}},null,8,["modelValue","placeholder"]),o(b,{class:"captcha-btn",loading:c.value,disabled:f.value,size:"large",onClick:V},{default:n(()=>[y(C(t.value),1)]),_:1},8,["loading","disabled"])]),_:1},8,["rules"]),o(i,null,{default:n(()=>[o(x,{direction:"vertical",fill:"",class:"w-full"},{default:n(()=>[o(b,{disabled:!a.captcha,class:"btn",type:"primary",loading:p.value,"html-type":"submit",size:"large",long:""},{default:n(()=>[y(C(e.$t("login.form.login")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model"])}}});const ae=S(W,[["__scopeId","data-v-3b7890ed"]]);export{ae as default};
