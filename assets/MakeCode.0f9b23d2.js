import{B as z,I as Z,i as O,m as K,y as _,_ as W}from"./index.afcd2e8c.js";/* empty css                *//* empty css               *//* empty css              */import{d as X,r as f,aP as I,aK as N,F as n,aH as s,aT as o,H as P,aU as l,aW as m,aI as F,bn as Y,G as h,aY as k,aV as U,aX as $,b3 as j,bq as J,br as Q,bK as x,be as uu,bg as eu,bf as au,bx as ou,c5 as lu,bm as tu,ba as nu,bd as ru,bN as du,cb as iu}from"./arco.31164f47.js";import{a as su,b as mu,m as Eu}from"./generatecode.b5d7d855.js";import{c as pu}from"./common.bbd0496d.js";import{I as Fu}from"./IconPicker.c662fd96.js";import"./chart.0656511d.js";import"./vue.85c125e1.js";const fu=X({name:"MakeCode",components:{BasicModal:z,IconPicker:Fu,Icon:Z},emits:["success"],setup(u,{emit:e}){const H=f(520),S=f(["business","common","datacenter","matter","system","user","developer"]),a=f({rule_name:"",icon:"",codelocation:"busDirName",pid:0,component:"",routename:"",routepath:"",codetpl:"web",viewsdir:"",vuedir:"",goappdir:"business",godir:"",gofilename:"index"}),B=f([]),C=f(!1),A=f([]),i=f([]),d=f([]),{loading:D,setLoading:p}=O(),[g,{setModalProps:G,closeModal:y}]=K(async E=>{p(!0),w(),p(!1)}),b=f(),M=async()=>{try{await b.value?.validate()||(p(!0),I.loading({content:"\u751F\u6210\u4E2D",id:"upStatus",duration:2e3}),a.value.routename=a.value.vuedir,a.value.routepath="/"+a.value.routename,a.value.viewsdir?a.value.component=`${a.value.viewsdir}/${a.value.routename}/index`:a.value.component=`${a.value.routename}/index`,a.value.codetpl=="go"&&(a.value.rule_name=""),await Eu(a.value),I.success({content:"\u751F\u6210\u6210\u529F",id:"upStatus",duration:2e3}),y(),e("success"),p(!1))}catch{p(!1),I.loading({content:"\u751F\u6210\u4E2D",id:"upStatus",duration:1})}},w=async()=>{a.value.viewsdir="",a.value.codelocation=="busDirName"?a.value.goappdir="business":a.value.codelocation=="adminDirName"?a.value.goappdir="admin":a.value.goappdir="";const E=await su({codelocation:a.value.codelocation}),v=[{id:0,title:"\u4E00\u7EA7\u83DC\u5355",pid:0,locale:""}];E.list?B.value=v.concat(E.list):B.value=[],_(E.ids,a.value.pid)||(a.value.pid=0),V(a.value.pid);const r=await mu({codelocation:a.value.codelocation});C.value=r.haseadmin,A.value=r.go_app_dir,d.value=r.views_dir,r.go_file_dir&&r.go_file_dir.forEach(R=>{const c=R.split("/");c&&c.length>1&&!_(S.value,c[1])&&i.value.push({bdir:c[0],value:c[1],title:R})})},V=E=>{a.value.viewsdir="",a.value.codelocation=="busDirName"?a.value.goappdir="business":a.value.codelocation=="adminDirName"?a.value.goappdir="admin":a.value.goappdir="";const v=B.value.find(r=>r.id==E);if(v&&v.routepath){const r=v.routepath.split("/")[1].trim();r&&(_(d.value,r)&&(a.value.viewsdir=r),a.value.codetpl=="goweb"&&(a.value.godir=r),_(A.value,r)&&(a.value.goappdir=r))}};return{registerModal:g,getTitle:"\u672C\u5DE5\u5177\u7528\u4E8E\u4E0D\u4F9D\u9760\u6570\u636E\u8868\u7ED3\u6784\u751F\u6210\u4EE3\u7801\u6A21\u677F",loading:D,modelHeight:H,handleSubmit:M,formRef:b,formData:a,handleChangeMenu:V,parntList:B,handleGetMenuList:w,haseadmin:C,go_app_dir:A,views_dir:d,go_file_dir:i,handleGoPath:()=>{},handleChangeRoutename:()=>{a.value.vuedir=a.value.routename,a.value.codetpl=="goweb"&&(a.value.gofilename=a.value.routename)},handleChekHaseRule:(E,v)=>new Promise(async r=>{E&&(await pu({id:0,codelocation:a.value.codelocation,routename:E})||v("\u8BE5\u8DEF\u7531\u5DF2\u88AB\u5360\u7528\u8BF7\u6362\u4E00\u4E2A")),r(!0)}),handdleCodetpl:()=>{a.value.codetpl=="go"&&(a.value.rule_name="")}}}});const Du={class:"table-content"};function gu(u,e,H,S,a,B){const C=J,A=Q,i=x,d=uu,D=eu,p=au,g=ou,G=lu,y=N("Icon"),b=tu,M=N("IconPicker"),w=nu,V=ru,L=du,T=iu,q=N("BasicModal");return n(),s(q,j(u.$attrs,{onRegister:u.registerModal,isPadding:!1,loading:u.loading,width:"900px",minHeight:u.modelHeight,title:u.getTitle,onOk:u.handleSubmit}),{default:o(()=>[P("div",Du,[l(L,{ref:"formRef",model:u.formData,"auto-label-width":""},{default:o(()=>[l(V,{gutter:16},{default:o(()=>[l(d,{span:12},{default:o(()=>[l(i,{label:"\u4EE3\u7801\u751F\u6210\u4F4D\u7F6E",field:"codelocation",style:{"margin-bottom":"15px"}},{default:o(()=>[l(A,{modelValue:u.formData.codelocation,"onUpdate:modelValue":e[0]||(e[0]=t=>u.formData.codelocation=t),onChange:u.handleGetMenuList},{default:o(()=>[l(C,{value:"busDirName"},{default:o(()=>[...e[12]||(e[12]=[m("business(B\u7AEF)",-1)])]),_:1}),l(C,{value:"adminDirName",disabled:!u.haseadmin},{default:o(()=>[...e[13]||(e[13]=[m("admin(A\u7AEF)",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),l(d,{span:12},{default:o(()=>[l(i,{field:"codetpl",label:"\u4EE3\u7801\u6A21\u677F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u751F\u6210\u4EE3\u7801\u6A21\u677F"}]},{default:o(()=>[l(p,{modelValue:u.formData.codetpl,"onUpdate:modelValue":e[1]||(e[1]=t=>u.formData.codetpl=t),placeholder:"\u9009\u62E9\u751F\u6210\u4EE3\u7801\u6A21\u677F",onChange:u.handdleCodetpl},{default:o(()=>[l(D,{value:"web"},{default:o(()=>[...e[14]||(e[14]=[m("\u4EC5\u524D\u7AEF\u4EE3\u7801",-1)])]),_:1}),l(D,{value:"go"},{default:o(()=>[...e[15]||(e[15]=[m("\u4EC5\u540E\u7AEF\u4EE3\u7801",-1)])]),_:1}),l(D,{value:"goweb"},{default:o(()=>[...e[16]||(e[16]=[m("\u540E\u7AEF\u548C\u524D\u7AEF\u4EE3\u7801",-1)])]),_:1})]),_:1},8,["modelValue","onChange"])]),_:1})]),_:1}),u.formData.codetpl!="go"?(n(),s(d,{key:0,span:12},{default:o(()=>[l(i,{field:"rule_name",label:"\u83DC\u5355\u540D\u79F0","validate-trigger":"input",extra:"\u8BF7\u6C42\u540E\u53F0\u9875\u9762router\u8DEF\u7531"},{default:o(()=>[l(g,{modelValue:u.formData.rule_name,"onUpdate:modelValue":e[2]||(e[2]=t=>u.formData.rule_name=t),placeholder:"\u586B\u751F\u6210\u7684\u83DC\u5355\u540D\u79F0\uFF08\u4E0D\u9700\u8981\u83DC\u5355\u5C31\u4E0D\u521B\u5EFA\uFF09","max-length":50,"allow-clear":"","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),u.formData.rule_name?(n(),s(d,{key:1,span:12},{default:o(()=>[l(i,{field:"pid",label:"\u5DE6\u4FA7\u83DC\u5355","validate-trigger":"input",extra:"\u751F\u6210\u7CFB\u7EDF\u83DC\u5355\u5373\u5728\u5DE6\u8FB9\u8DEF\u7531\u4E2D\uFF0C\u82E5\u83DC\u5355\u6709\u7279\u6B8A\u53EF\u5728\u7CFB\u7EDF\u8BBE\u7F6E"},{default:o(()=>[l(G,{placeholder:"\u9009\u62E9\u4E0A\u7EA7\u83DC\u5355",data:u.parntList,onChange:u.handleChangeMenu,fieldNames:{key:"id",title:"title",children:"children"},modelValue:u.formData.pid,"onUpdate:modelValue":e[3]||(e[3]=t=>u.formData.pid=t)},null,8,["data","onChange","modelValue"])]),_:1})]),_:1})):F("",!0),u.formData.rule_name?(n(),s(d,{key:2,span:12},{default:o(()=>[l(i,{field:"routename",label:"\u8DEF\u7531\u540D","validate-trigger":["input","change","blur"],rules:[{required:!0,message:"\u8BF7\u586B\u8BF7\u6C42\u8DEF\u7531\u540D\u79F0"},{match:/^[A-Za-z0-9]+$/,message:"\u8DEF\u7531\u5FC5\u987B\u7531\u5B57\u6BCD\u6570\u5B57\u7EC4\u6210"},{validator:u.handleChekHaseRule}],extra:"vue-router\u8DEF\u7531routename\u7684\u540D\u79F0"},{default:o(()=>[l(g,{modelValue:u.formData.routename,"onUpdate:modelValue":e[4]||(e[4]=t=>u.formData.routename=t),placeholder:"\u586B\u751F\u6210\u7684\u524D\u7AEF\u8BF7\u6C42\u8DEF\u7531\u540D\u79F0","max-length":50,"allow-clear":"","show-word-limit":"",onBlur:u.handleChangeRoutename},null,8,["modelValue","onBlur"])]),_:1},8,["rules"])]),_:1})):F("",!0),u.formData.rule_name?(n(),s(d,{key:3,span:12},{default:o(()=>[l(i,{label:"\u83DC\u5355\u56FE\u6807",field:"icon",style:{"margin-bottom":"15px"},extra:"\u9009\u62E9\u5668\u6CA1\u6709\u627E\u5230\u56FE\u6807\u53EF\u4EE5\u53BBarco\u548C\u81EA\u5DF1\u6DFB\u52A0\u7684\u963F\u91CCicon\u590D\u5236"},{default:o(()=>[l(g,{modelValue:u.formData.icon,"onUpdate:modelValue":e[5]||(e[5]=t=>u.formData.icon=t),placeholder:"\u9009\u62E9\u56FE\u6807/\u586B\u5199"},Y({_:2},[u.formData.icon?{name:"prefix",fn:o(()=>[l(y,{icon:u.formData.icon},null,8,["icon"])]),key:"0"}:void 0]),1032,["modelValue"]),l(w,{position:"br",trigger:"click"},{content:o(()=>[l(M,{modelValue:u.formData.icon,"onUpdate:modelValue":e[6]||(e[6]=t=>u.formData.icon=t)},null,8,["modelValue"])]),default:o(()=>[l(b,{type:"primary"},{default:o(()=>[...e[17]||(e[17]=[m("\u9009\u62E9",-1)])]),_:1})]),_:1})]),_:1})]),_:1})):F("",!0),u.formData.codetpl!="go"?(n(),s(d,{key:4,span:12},{default:o(()=>[l(i,{field:"viewsdir",label:"\u524D\u7AEF\u7236\u76EE\u5F55","validate-trigger":"input",extra:"\u662F\u751F\u6210\u4EE3\u7801views\u4E2D\u90A3\u4E2A\u5B50\u76EE\u5F55\u91CC,\u4E0D\u9009\u5219\u76F4\u63A5\u653E\u5728views\u4E2D"},{default:o(()=>[l(p,{modelValue:u.formData.viewsdir,"onUpdate:modelValue":e[7]||(e[7]=t=>u.formData.viewsdir=t),placeholder:"\u9009\u62E9\u751F\u6210\u524D\u7AEF\u4EE3\u7801\u653E\u5728views\u76EE\u5F55\u90A3\u4E2A\u4F4D\u7F6E","allow-clear":"","allow-create":""},{default:o(()=>[(n(!0),h(k,null,U(u.views_dir,t=>(n(),s(D,{value:t},{default:o(()=>[m($(t),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),u.formData.codetpl!="go"?(n(),s(d,{key:5,span:12},{default:o(()=>[l(i,{field:"vuedir",label:"\u524D\u7AEF\u65B0\u4E1A\u52A1","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u6587\u4EF6\u540D\u79F0"},{match:/^[A-Za-z]+$/,message:"\u5FC5\u987B\u7531\u5B57\u6BCD\u7EC4\u6210"}],extra:"\u8FD9\u4E2A\u65B0\u589E\u7684\u4EE3\u7801\u76EE\u5F55\uFF0C\u91CC\u9762\u5B58\u653Eindex.vue\u7B49\u6587\u4EF6"},{default:o(()=>[l(g,{modelValue:u.formData.vuedir,"onUpdate:modelValue":e[8]||(e[8]=t=>u.formData.vuedir=t),placeholder:"\u8BF7\u586B\u521B\u5EFA\u6587\u4EF6\u540D","max-length":50,"allow-clear":"","show-word-limit":"",onBlur:u.handleGoPath},null,8,["modelValue","onBlur"])]),_:1})]),_:1})):F("",!0),u.formData.codetpl!="web"?(n(),s(d,{key:6,span:12},{default:o(()=>[l(i,{field:"goappdir",label:"\u540E\u7AEF\u6A21\u5757\u76EE\u5F55","validate-trigger":"input",extra:"\u540E\u7AEF\u6A21\u5757\u76EE\u5F55,\u5982\u679C\u8981\u521B\u5EFA\u65B0\u6A21\u5757\u5C31\u4E0D\u7528\u9009(\u7A7A)"},{default:o(()=>[l(p,{modelValue:u.formData.goappdir,"onUpdate:modelValue":e[9]||(e[9]=t=>u.formData.goappdir=t),placeholder:"\u9009\u62E9\u4EE3\u7801\u653E\u5728app\u76EE\u5F55\u4E2D\u6A21\u5757(\u5982business)","allow-clear":"","allow-create":""},{default:o(()=>[(n(!0),h(k,null,U(u.go_app_dir,t=>(n(),s(D,{value:t},{default:o(()=>[m($(t),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),u.formData.codetpl!="web"?(n(),s(d,{key:7,span:12},{default:o(()=>[l(i,{field:"godir",label:"\u540E\u7AEF\u7C7B\u76EE\u5F55","validate-trigger":"input",rules:[{required:!0,message:"\u8BF7\u586B\u540E\u7AEF\u76EE\u5F55"},{match:/^[A-Za-z]+$/,message:"\u5FC5\u987B\u7531\u5B57\u6BCD\u7EC4\u6210"}],extra:"\u9009\u62E9\u7684\u76EE\u5F55\u4E0D\u5B58\u5728\u53EF\u4EE5\u521B\u5EFA\u65B0\u76EE\u5F55"},{default:o(()=>[l(p,{modelValue:u.formData.godir,"onUpdate:modelValue":e[10]||(e[10]=t=>u.formData.godir=t),placeholder:"\u9009\u62E9\u6216\u521B\u5EFA\u65B0\u4EE3\u7801\u6587\u4EF6\u6240\u5728\u76EE\u5F55","allow-clear":"","allow-create":""},{default:o(()=>[(n(!0),h(k,null,U(u.go_file_dir,t=>(n(),h(k,null,[t.bdir==u.formData.goappdir?(n(),s(D,{key:0,value:t.value,label:t.value},{default:o(()=>[m($(t.title),1)]),_:2},1032,["value","label"])):F("",!0)],64))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1})):F("",!0),u.formData.codetpl!="web"?(n(),s(d,{key:8,span:12},{default:o(()=>[l(i,{field:"gofilename",label:"go\u6587\u4EF6\u76EE\u5F55","validate-trigger":"input",extra:`go\u6587\u4EF6\u540D\u79F0\u9ED8\u8BA4index\uFF0C\u6587\u4EF6\u4E3A${u.formData.gofilename}.go`,rules:[{match:/^[A-Za-z]+$/,message:"\u6587\u4EF6\u540D\u5FC5\u7531\u5B57\u6BCD\u7EC4\u6210"}]},{default:o(()=>[l(g,{modelValue:u.formData.gofilename,"onUpdate:modelValue":e[11]||(e[11]=t=>u.formData.gofilename=t),placeholder:"\u586B\u751F\u6210go\u6587\u4EF6\u540D","allow-clear":""},null,8,["modelValue"])]),_:1},8,["extra"])]),_:1})):F("",!0)]),_:1})]),_:1},8,["model"]),l(T,{type:"warning"},{title:o(()=>[...e[18]||(e[18]=[m("\u6E29\u99A8\u63D0\u793A",-1)])]),default:o(()=>[e[19]||(e[19]=m(" 1.\u4F60\u53EF\u4EE5\u4F7F\u7528\u8BE5\u5DE5\u5177\u5FEB\u901F\u751F\u6210\u5F00\u53D1\u4EE3\u7801\u6587\u4EF6\uFF0C\u5E2E\u52A9\u60A8\u5FEB\u901F\u6784\u67B6\u597D\u7F16\u8F91\u4EE3\u7801\u6587\u4EF6\u3002",-1)),e[20]||(e[20]=P("br",null,null,-1)),e[21]||(e[21]=m(" 2.\u521B\u5EFA\u7684\u6587\u4EF6\u4F1A\u5728\u4F60\u9009\u62E9\u7684\u521B\u5EFA\u4E0B\uFF0C\u6CA1\u6709\u9009\u62E9\u5219\u540E\u7AEF\u5728app\u76EE\u5F55\u4E0B\uFF0C\u524D\u7AEF\u5728src/views\u76EE\u5F55\u4E0B\u3002",-1)),e[22]||(e[22]=P("br",null,null,-1)),e[23]||(e[23]=m(" 3.\u5378\u8F7D\u8BF7\u5728\u5217\u8868\u6570\u636E\u627E\u5230\u751F\u6210\u65B9\u5F0F\u4E3A\u201C\u4EE3\u7801\u6A21\u677F\u751F\u6210\u201D\u627E\u5230\u521A\u751F\u4EA7\u6570\u636E\uFF0C\u5728\u64CD\u4F5C\u680F\u70B9\u51FB\u5220\u9664\u5373\u53EF\u3002 ",-1))]),_:1})])]),_:1},16,["onRegister","loading","minHeight","title","onOk"])}const ku=W(fu,[["render",gu],["__scopeId","data-v-b4faf2da"]]);export{ku as default};
